<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Dashboard</title>
    <meta name="description" content="Dashboard">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="apple-icon.png">

    <link rel="stylesheet" href="assets/css/normalize.css">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/themify-icons.css">
    <link rel="stylesheet" href="assets/css/flag-icon.min.css">
    <link rel="stylesheet" href="assets/css/cs-skin-elastic.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
    crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="assets/css/bootstrap-select.less"> -->
    <link rel="stylesheet" href="assets/scss/style.css">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/css'>

    <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv.min.js"></script> -->
    <style>
            /* Always set the map height explicitly to define the size of the div
             * element that contains the map. */
            #map {
              height: 50%;
            }
            html, body {
        height: 100%;
      }
            /* Optional: Makes the sample page fill the window. */

            #floating-panel {
              position: absolute;
              top: 10px;
              left: 25%;
              z-index: 5;
              background-color: #fff;
              padding: 5px;
              border: 1px solid #999;
              text-align: center;
              font-family: 'Roboto','sans-serif';
              line-height: 30px;
              padding-left: 10px;
            }
            #floating-panel {
              background-color: #fff;
              border: 1px solid #999;
              left: 25%;
              padding: 5px;
              position: absolute;
              top: 10px;
              z-index: 5;
            }
          </style>
</head>
<body>

    
    <!-- Right Panel -->
    
    <div id="right-panel" class="right-panel">

        <!-- Header-->
        <header id="header" class="header">

            <div class="header-menu">

                <div class="col-sm-7">
                    <div class="header-left">
                        <button class="search-trigger"><i class="fa fa-search"></i></button>
                        <div class="form-inline">
                            <form class="search-form">
                                <input class="form-control mr-sm-2" type="text" placeholder="Search ..." aria-label="Search">
                                <button class="search-close" type="submit"><i class="fa fa-close"></i></button>
                            </form>
                        </div>

                        <div class="dropdown for-notification">
                          <button class="btn btn-secondary dropdown-toggle" type="button" id="notification" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-bell"></i>
                            <span class="count bg-danger">5</span>
                          </button>
                          <div class="dropdown-menu" aria-labelledby="notification">
                            <p class="red">You have 3 Notification</p>
                            <a class="dropdown-item media bg-flat-color-1" href="#">
                                <i class="fa fa-check"></i>
                                <p>Server #1 overloaded.</p>
                            </a>
                            <a class="dropdown-item media bg-flat-color-4" href="#">
                                <i class="fa fa-info"></i>
                                <p>Server #2 overloaded.</p>
                            </a>
                            <a class="dropdown-item media bg-flat-color-5" href="#">
                                <i class="fa fa-warning"></i>
                                <p>Server #3 overloaded.</p>
                            </a>
                          </div>
                        </div>

                        <div class="dropdown for-message">
                          <button class="btn btn-secondary dropdown-toggle" type="button"
                                id="message"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="ti-email"></i>
                            <span class="count bg-primary">9</span>
                          </button>
                          <div class="dropdown-menu" aria-labelledby="message">
                            <p class="red">You have 4 Mails</p>
                            <a class="dropdown-item media bg-flat-color-1" href="#">
                                <span class="message media-body">
                                    <span class="name float-left">Jonathan Smith</span>
                                    <span class="time float-right">Just now</span>
                                        <p>Hello, this is an example msg</p>
                                </span>
                            </a>
                            <a class="dropdown-item media bg-flat-color-4" href="#">
                                <span class="message media-body">
                                    <span class="name float-left">Jack Sanders</span>
                                    <span class="time float-right">5 minutes ago</span>
                                        <p>Lorem ipsum dolor sit amet, consectetur</p>
                                </span>
                            </a>
                            <a class="dropdown-item media bg-flat-color-5" href="#">
                                <span class="message media-body">
                                    <span class="name float-left">Cheryl Wheeler</span>
                                    <span class="time float-right">10 minutes ago</span>
                                        <p>Hello, this is an example msg</p>
                                </span>
                            </a>
                            <a class="dropdown-item media bg-flat-color-3" href="#">
                                <span class="message media-body">
                                    <span class="name float-left">Rachel Santos</span>
                                    <span class="time float-right">15 minutes ago</span>
                                        <p>Lorem ipsum dolor sit amet, consectetur</p>
                                </span>
                            </a>
                          </div>
                        </div>
                    </div>
                </div>

                <div class="col-sm-5">
                    <div class="user-area dropdown float-right">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <img class="user-avatar rounded-circle" src="images/admin.jpg" alt="User Avatar">
                        </a>

                        <div class="user-menu dropdown-menu">
                                <a class="nav-link" href="#"><i class="fa fa- user"></i>My Profile</a>

                                <a class="nav-link" href="#"><i class="fa fa- user"></i>Notifications <span class="count">13</span></a>

                                <a class="nav-link" href="#"><i class="fa fa -cog"></i>Settings</a>

                                <a class="nav-link" href="#"><i class="fa fa-power -off"></i>Logout</a>
                        </div>
                    </div>

                </div>
            </div>

        </header><!-- /header -->
        <!-- Header-->

        <div class="breadcrumbs">
            <div class="col-sm-4">
                <div class="page-header float-left">
                    <div class="page-title">
                        <h1>Dashboard</h1>
                    </div>
                </div>
            </div>
            <div class="col-sm-8">
                <div class="page-header float-right">
                    <div class="page-title">
                        <ol class="breadcrumb text-right">
                            <li class="active">Dashboard</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <div id="map"></div>

        <div class="content mt-3">
            <div class="col-xl-6" id="app">
                <p style="font-size: 20px">Ranking de Rotas</p>
                            <div class="card" v-for="rota in rotas">
                                <div class="card-body">
                                    <div class="stat-widget-one">
                                        <div class="stat-icon dib"><p style="font-size: 50px; color: black; margin-top: 20px;">{{rota.ranking}}º</p></div>
                                        <div class="stat-content dib">
                                            <div class="stat-text">{{rota.name}}</div>
                                            <div class="stat-digit">{{rota.views}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            

            </div>

            <div class="col-xl-6">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-sm-4">
                                <h4 class="card-title mb-0">Trafégo</h4>
                                <div class="small text-muted">Maio 2018</div>
                            </div>

                        </div><!--/.row-->
                        <div class="chart-wrapper mt-4" />
                            <canvas id="trafficChart" style="height:200px;" height="200"></canvas>
                        </div>

                    </div>
                    <div class="card-footer" id="app2">
                        <ul>
                            <li>
                                <div class="text-muted">Circuito Náutico de Cacha-Pregos</div>
                                <div class="progress progress-xs mt-2" style="height: 5px;">
                                    <div class="progress-bar bg-success" role="progressbar" style="width: 40%;" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </li>
                            <li class="hidden-sm-down">
                                <div class="text-muted">Rolé perfeito para os últimos dias do Verão</div>
                                <div class="progress progress-xs mt-2" style="height: 5px;">
                                    <div class="progress-bar bg-info" role="progressbar" style="width: 40%;" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </li>
                            <li>
                                <div class="text-muted">Forte São Marcelo</div>
                                <div class="progress progress-xs mt-2" style="height: 5px;">
                                    <div class="progress-bar bg-warning" role="progressbar" style="width: 40%;" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </li>
                            <li class="hidden-sm-down">
                                <div class="text-muted">Visita a Cacha-Pregos</div>
                                <div class="progress progress-xs mt-2" style="height: 5px;">
                                    <div class="progress-bar bg-danger" role="progressbar" style="width: 40%;" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </li>
                            <li class="hidden-sm-down">
                                <div class="text-muted">Arqueologia na Baía</div>
                                <div class="progress progress-xs mt-2" style="height: 5px;">
                                    <div class="progress-bar" role="progressbar" style="width: 40%;" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>


        </div> <!-- .content -->
    </div><!-- /#right-panel -->

    <!-- Right Panel -->

    <script src="assets/js/vendor/jquery-2.1.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"></script>
    <script src="assets/js/plugins.js"></script>
    <script src="assets/js/main.js"></script>


    <script src="assets/js/lib/chart-js/Chart.bundle.js"></script>
    <script src="assets/js/dashboard.js"></script>
    <script src="assets/js/widgets.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.0.3/firebase.js"></script>
  <script>
        // Initialize Firebase
        var config = {
          apiKey: "AIzaSyDsCcKMRngL9JSanuWcwoWwV_uQ3c6abuE",
          authDomain: "ola-baia.firebaseapp.com",
          databaseURL: "https://ola-baia.firebaseio.com",
          projectId: "ola-baia",
          storageBucket: "ola-baia.appspot.com",
          messagingSenderId: "363436448639"
        };
        firebase.initializeApp(config);
        const db = firebase.firestore();
        db.settings({ timestampsInSnapshots: true });
    
    
      </script>
      <script src="../lib/itinerary.js"></script>    
    <script>

            // This example requires the Visualization library. Include the libraries=visualization
            // parameter when you first load the API. For example:
            // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=visualization">
      
            var map, heatmap;
      
            function initMap() {
              map = new google.maps.Map(document.getElementById('map'), {
                zoom: 10,
                center: {lat: -12.9208526, lng: -38.7347012},
              });
      
              heatmap = new google.maps.visualization.HeatmapLayer({
                data: getPoints(),
                map: map
              });
            }
      
      
            // Heatmap data: 500 Points
            function getPoints() {
              return [
                new google.maps.LatLng(-12.8947712, -38.6881958),
                new google.maps.LatLng(-12.8947710, -38.6881958),
                new google.maps.LatLng(-12.8947711, -38.6881958),
                new google.maps.LatLng(-12.8947715, -38.6881958),
                new google.maps.LatLng(-12.8947716, -38.6881958),
                new google.maps.LatLng(-12.8947716, -38.6881951),
                new google.maps.LatLng(-12.8947716, -38.6881952),
                new google.maps.LatLng(-12.8947716, -38.6881953),
                new google.maps.LatLng(-12.8947712, -38.6881958),
                new google.maps.LatLng(-12.9600243, -38.6215124),
                new google.maps.LatLng(-12.9600240, -38.6215121),
                new google.maps.LatLng(-12.9600241, -38.6215132),
                new google.maps.LatLng(-12.9600241, -38.6215142),
                new google.maps.LatLng(-12.9600241, -38.6215152),
                new google.maps.LatLng(-12.9600241, -38.6215122),
                new google.maps.LatLng(-12.9600251, -38.6215112),
                new google.maps.LatLng(-12.9600221, -38.6215132),
                new google.maps.LatLng(-12.9600231, -38.6215162),
                new google.maps.LatLng(-12.9600241, -38.6215182),
                new google.maps.LatLng(-13.1188158, -38.7970957),
                new google.maps.LatLng(-13.1188111, -38.7970947),
                new google.maps.LatLng(-13.1188122, -38.7970937),
                new google.maps.LatLng(-13.1188133, -38.7970927),
                new google.maps.LatLng(-13.1188114, -38.7970957),
                new google.maps.LatLng(-13.1188155, -38.7970967),
                new google.maps.LatLng(-13.1188155, -38.7970967),
                new google.maps.LatLng(-13.1182155, -38.7970967),
                new google.maps.LatLng(-13.1183155, -38.7970967),
                new google.maps.LatLng(-13.1183155, -38.7970967),
                new google.maps.LatLng(-13.1183155, -38.7970967),
                new google.maps.LatLng(-13.1183155, -38.7970967),
                new google.maps.LatLng(-13.1183155, -38.7970967),
                new google.maps.LatLng(-13.1183155, -38.7970967),
                new google.maps.LatLng(-13.1183155, -38.7970967),
                new google.maps.LatLng(-13.1183155, -38.7970967),
                new google.maps.LatLng(-13.1183155, -38.7970967),
                new google.maps.LatLng(-12.78505, -38.6401557),
                new google.maps.LatLng(-12.78502, -38.6401557),
                new google.maps.LatLng(-12.78503, -38.6401557),
                new google.maps.LatLng(-12.78501, -38.6401557),
                new google.maps.LatLng(-12.78505, -38.6401557),
                new google.maps.LatLng(-12.71505, -38.6401557),
                new google.maps.LatLng(-12.72505, -38.6401557),
                new google.maps.LatLng(-12.72505, -38.6401257),
                new google.maps.LatLng(-12.72505, -38.6501557),
                new google.maps.LatLng(-12.72505, -38.6501557),
                new google.maps.LatLng(-12.72505, -38.6501557),
                new google.maps.LatLng(-12.72505, -38.6501557),
                new google.maps.LatLng(-12.72505, -38.6501557),
                new google.maps.LatLng(-12.72505, -38.6501557),
                new google.maps.LatLng(-12.72505, -38.6501557),
                new google.maps.LatLng(-12.72505, -38.6501557),
                new google.maps.LatLng(-12.72505, -38.6501557),
                new google.maps.LatLng(-12.72505, -38.6501557),
                new google.maps.LatLng(-12.960655,-38.6502177),
                new google.maps.LatLng(-12.910655,-38.6502177),
                new google.maps.LatLng(-12.970655,-38.6502177),
                new google.maps.LatLng(-12.930655,-38.6502177),
                new google.maps.LatLng(-12.920655,-38.6502177),
                new google.maps.LatLng(-13.054049,-38.7124287),
                new google.maps.LatLng(-13.054049,-38.7124287),
                new google.maps.LatLng(-13.0606214,-38.8028371),
                new google.maps.LatLng(-13.0706214,-38.8028371),
                new google.maps.LatLng(-13.0806214,-38.8028371),
              ];
            }

           
          </script>
          <script async defer
              src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBbnu4jRF4B6JZVDmyr7Ue4_bXIIXuBq7M&libraries=visualization&callback=initMap">
          </script>
    <script>

        var app = new Vue({
          el: '#app',
          data: {
            rotas: []
          },
          methods: {
            detalhe: (id) => {
              location.href = "details.html?id=" + id;
            }
          },
          created: () => {
            getItineraries().then(its => {
    
              its.forEach(it => {
                console.log(it);
                getGuide(it.id).then(guide => console.log(guide));
                getStops(it.id).then(stops => {
                  getGuide(it.id).then(guide => {
                    it.language = guide.languages.join(", ");
                    it.stops = stops;
                    it.days = stops.reduce((acc, cur) => {
                      acc += cur.duration_in_seconds;
                      return acc;
                    }, 0) / 60 / 24 ;
                    app.rotas.push(it);
                    sortByViews();
                  })
                })
              })
              
            })
          }
        })
    
    
        function sortByViews () {
          app.rotas = app.rotas.sort((a,b) => a.views < b.views).filter((rota, index) => index < 5);
          app.rotas.map((rota, index) => rota.ranking = index + 1);
        }
      </script>

</body>
</html>
